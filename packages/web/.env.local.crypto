# ====================================
# CRYPTOCURRENCY PAYMENT CONFIGURATION
# ====================================
# Copy this file to .env.local and fill in the values

# NOWPayments (Convenient Mode - 300+ Cryptocurrencies)
# ===================================================
NOWPAYMENTS_API_KEY=your-nowpayments-api-key-here
NOWPAYMENTS_IPN_SECRET=your-nowpayments-ipn-secret-here
NOWPAYMENTS_SANDBOX=true  # Set to false for production
NEXT_PUBLIC_APP_URL=http://localhost:3001  # Update with your tunnel URL or production domain

# BTCPay Server (Sovereign Mode - BTC, Lightning, Monero)
# =======================================================
# Leave these empty to disable BTCPay and show only NOWPayments
# Fill these in after setting up BTCPay Server (see DUAL_CRYPTO_QUICKSTART.md)

BTCPAY_SERVER_URL=http://localhost:14142  # Or https://btcpay.your-domain.com
BTCPAY_API_KEY=  # Get from: BTCPay → Account Settings → API Keys
BTCPAY_STORE_ID=  # Get from: BTCPay → Store URL (the UUID in the URL)
BTCPAY_WEBHOOK_SECRET=  # Generate with: openssl rand -hex 32

# ====================================
# QUICK START INSTRUCTIONS
# ====================================

# 1. TEST NOWPAYMENTS (5 MINUTES):
#    - Copy this file to .env.local
#    - Start dev server: pnpm dev
#    - Visit: http://localhost:3001/pricing
#    - Click: "Or pay with crypto"
#    - Test with sandbox mode

# 2. ADD BTCPAY (OPTIONAL - 30 MINUTES):
#    - Start BTCPay: docker-compose -f docker-compose.btcpay.yml up -d
#    - Access: http://localhost:14142
#    - Create admin account + store
#    - Get API key and Store ID
#    - Fill in BTCPAY_* variables above
#    - Restart: pnpm dev

# 3. EXPOSE FOR WEBHOOKS:
#    - Option A (Simplest): ssh -R 80:localhost:3001 nokey@localhost.run
#    - Option B (Best): cloudflared tunnel --url http://localhost:3001
#    - Copy tunnel URL to NEXT_PUBLIC_APP_URL above
#    - Configure webhook in NOWPayments dashboard

# 4. CONFIGURE NOWPAYMENTS WEBHOOKS:
#    - Go to: https://account.nowpayments.io/fr/store-settings#notifications
#    - IPN Callback URL: {NEXT_PUBLIC_APP_URL}/api/webhooks/crypto
#    - Save settings

# 5. CONFIGURE BTCPAY WEBHOOKS (if using BTCPay):
#    - Go to: http://localhost:14142 → Store Settings → Webhooks
#    - Add webhook: {NEXT_PUBLIC_APP_URL}/api/webhooks/btcpay
#    - Events: Invoice Settled, Invoice Processing, Invoice Expired
#    - Secret: Use same as BTCPAY_WEBHOOK_SECRET above

# ====================================
# TESTING CHECKLIST
# ====================================

# NOWPayments Sandbox:
# - [ ] Modal opens with dual provider selection
# - [ ] Convenient Mode shows 6 currencies (XMR, BTC, ETH, USDT, SOL, DOGE)
# - [ ] QR code displays after selecting currency
# - [ ] Payment address shown with copy button
# - [ ] Countdown timer works
# - [ ] Status polling updates every 10 seconds
# - [ ] Payment auto-completes in sandbox (5-10 sec)

# BTCPay Server (if configured):
# - [ ] Modal shows Sovereign Mode option
# - [ ] Sovereign Mode shows 3 methods (BTC, Lightning, Monero)
# - [ ] Invoice created in BTCPay dashboard
# - [ ] Multiple payment methods displayed
# - [ ] QR codes generated for each method
# - [ ] Testnet addresses shown correctly

# ====================================
# PRODUCTION DEPLOYMENT
# ====================================

# Before going live:
# 1. Switch NOWPAYMENTS_SANDBOX=false
# 2. Update NEXT_PUBLIC_APP_URL to production domain
# 3. Change BTCPay Docker to mainnet (if using)
# 4. Test with small real payment first
# 5. Monitor webhooks in production

# ====================================
# TROUBLESHOOTING
# ====================================

# Issue: "BTCPay Server not configured"
# Solution: This is normal if BTCPAY_API_KEY is empty
#           Only NOWPayments will be available

# Issue: Webhooks not received
# Solution: Verify tunnel is running and IPN URL is correct
#           Test webhook URL: curl {NEXT_PUBLIC_APP_URL}/api/webhooks/crypto

# Issue: Modal doesn't open
# Solution: Check browser console for errors
#           Verify pnpm dev is running
#           Clear browser cache

# ====================================
# SUPPORT
# ====================================

# Documentation:
# - DUAL_CRYPTO_QUICKSTART.md - Complete setup guide
# - CRYPTO_PAYMENT_SETUP.md - NOWPayments details
# - BTCPAY_LOCAL_SETUP.md - BTCPay Server setup
# - CLOUDFLARE_TUNNEL_SETUP.md - Tunneling guide

# Need help?
# - BTCPay: https://docs.btcpayserver.org/
# - NOWPayments: https://nowpayments.io/help/
# - Cloudflare: https://developers.cloudflare.com/cloudflare-one/
